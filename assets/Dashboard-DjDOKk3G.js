import{u as H}from"./device-Cstu3Uc2.js";import{i as S,L as R}from"./index-B-ioSKa-.js";import{d as P,p as j,m as k,q as E,s as q,x as U,y as J,r as w,z as K,o as Q,a as X,c as v,b as e,F as A,i as F,j as r,l as p,A as V,B as D,t as i,n as B,C as Y,D as Z,k as ee,E as d,G as te,H as ae,I as se,f as c,_ as le}from"./index-BFAmLiXm.js";const oe={class:"page-container"},re={class:"dashboard"},ie={class:"grid grid-cols-4",style:{"margin-bottom":"20px"}},ne={class:"kpi-content"},de={class:"kpi-label"},ce={class:"kpi-value-group"},ue={class:"kpi-value"},ve={key:0,class:"kpi-unit"},pe={class:"kpi-sub-text"},fe={class:"grid grid-cols-3",style:{"margin-bottom":"20px"}},me={class:"module-card col-span-2"},_e={class:"module-header"},ge={class:"header-left"},he={class:"header-right"},be={class:"module-card"},ye={class:"module-header"},xe={class:"header-left"},Ce={class:"realtime-panel"},Se={class:"panel-group"},ke={class:"data-row"},we={class:"cell-label"},Ae={class:"panel-group"},Fe={class:"data-row"},De={class:"cell-label"},Be={class:"cell-value info"},Le={class:"panel-group horizontal"},Te={class:"data-cell-lg"},ze={class:"cell-value warning"},Re={class:"data-cell-lg"},Ee={class:"grid grid-cols-2"},Ve={class:"module-card"},Oe={class:"module-header"},We={class:"header-left"},Ie={class:"module-card"},Ne={class:"module-header"},$e={class:"header-left"},Ge=P({__name:"Dashboard",setup(Me){const f=H(),{statistics:l,realtimeData:n}=j(f),O=k(()=>(n.value.power[0]||0)+(n.value.power[1]||0)+(n.value.power[2]||0)),L=k(()=>((n.value.temperature[0]||0)+(n.value.temperature[1]||0)+(n.value.temperature[2]||0))/3),W=k(()=>[{label:"在线设备",value:l.value.onlineDevices,unit:"台",subText:`总设备: ${l.value.totalDevices}`,icon:E,type:"success"},{label:"告警设备",value:l.value.warningDevices,unit:"台",subText:"需要关注",icon:q,type:"warning"},{label:"严重告警",value:l.value.criticalAlarms,unit:"条",subText:`总告警: ${l.value.totalAlarms}`,icon:U,type:"danger"},{label:"待处理工单",value:l.value.pendingWorkOrders,unit:"个",subText:`总工单: ${l.value.totalWorkOrders}`,icon:J,type:"info"}]),h=w(),b=w(),y=w();let g=null,m=null,_=null,x;const I=()=>{if(!h.value)return;g=S(h.value);const s=[],t=[],o=[];for(let a=0;a<24;a++)s.push(`${a}:00`),t.push(380+Math.random()*40),o.push(50+Math.random()*150);const C={backgroundColor:"transparent",grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},tooltip:{trigger:"axis",backgroundColor:"rgba(11, 19, 37, 0.9)",borderColor:"#00F3FF",textStyle:{color:"#fff"}},legend:{data:["电压","电流"],textStyle:{color:"#94A3B8"},top:0},xAxis:{type:"category",boundaryGap:!1,data:s,axisLine:{lineStyle:{color:"rgba(0, 243, 255, 0.2)"}},axisLabel:{color:"#94A3B8"}},yAxis:[{type:"value",name:"电压(V)",nameTextStyle:{color:"#94A3B8"},splitLine:{lineStyle:{color:"rgba(255,255,255,0.05)",type:"dashed"}},axisLabel:{color:"#94A3B8"}},{type:"value",name:"电流(A)",nameTextStyle:{color:"#94A3B8"},splitLine:{show:!1},axisLabel:{color:"#94A3B8"}}],series:[{name:"电压",type:"line",data:t,smooth:!0,itemStyle:{color:"#00E676"},areaStyle:{color:new R(0,0,0,1,[{offset:0,color:"rgba(0, 230, 118, 0.3)"},{offset:1,color:"rgba(0, 230, 118, 0.05)"}])}},{name:"电流",type:"line",yAxisIndex:1,data:o,smooth:!0,itemStyle:{color:"#00F3FF"},areaStyle:{color:new R(0,0,0,1,[{offset:0,color:"rgba(0, 243, 255, 0.3)"},{offset:1,color:"rgba(0, 243, 255, 0.05)"}])}}]};g.setOption(C)},N=()=>{b.value&&(m=S(b.value),T())},T=()=>{if(!m)return;const s={backgroundColor:"transparent",tooltip:{trigger:"item",backgroundColor:"rgba(11, 19, 37, 0.9)",borderColor:"#00F3FF",textStyle:{color:"#fff"}},legend:{orient:"vertical",right:"10%",top:"center",textStyle:{color:"#94A3B8"},itemWidth:10,itemHeight:10},series:[{name:"设备状态",type:"pie",radius:["50%","75%"],center:["35%","50%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:5,borderColor:"#0B1325",borderWidth:2},label:{show:!1},labelLine:{show:!1},data:[{value:l.value.onlineDevices,name:"在线",itemStyle:{color:"#00E676"}},{value:l.value.warningDevices,name:"告警",itemStyle:{color:"#FFD600"}},{value:l.value.offlineDevices,name:"离线",itemStyle:{color:"#94A3B8"}}]}]};m.setOption(s)},$=()=>{y.value&&(_=S(y.value),z())},z=()=>{if(!_)return;const s={backgroundColor:"transparent",tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:"rgba(11, 19, 37, 0.9)",borderColor:"#00F3FF",textStyle:{color:"#fff"}},grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},xAxis:{type:"category",data:["严重","告警","信息"],axisLine:{lineStyle:{color:"rgba(0, 243, 255, 0.2)"}},axisLabel:{color:"#94A3B8"}},yAxis:{type:"value",splitLine:{lineStyle:{color:"rgba(255,255,255,0.05)",type:"dashed"}},axisLabel:{color:"#94A3B8"}},series:[{name:"告警数量",type:"bar",barWidth:"30%",data:[{value:l.value.criticalAlarms,itemStyle:{color:"#FF2E63"}},{value:l.value.warningAlarms,itemStyle:{color:"#FFD600"}},{value:l.value.infoAlarms,itemStyle:{color:"#00B0FF"}}],label:{show:!0,position:"top",color:"#E2E8F0"}}]};_.setOption(s)},G=(s,t,o)=>s<t||s>o?"danger":s<t+5||s>o-5?"warning":"success",M=s=>s>60?"danger":s>50?"warning":"success";return K(()=>l.value,()=>{T(),z()},{deep:!0}),Q(async()=>{await f.fetchStatistics(),await f.fetchRealtimeData(),I(),N(),$(),window.addEventListener("resize",()=>{g?.resize(),m?.resize(),_?.resize()}),x=setInterval(()=>{f.fetchRealtimeData(),f.fetchStatistics()},5e3)}),X(()=>{g?.dispose(),m?.dispose(),_?.dispose(),x&&clearInterval(x),window.removeEventListener("resize",()=>{})}),(s,t)=>{const o=V("el-icon"),C=V("el-tag");return c(),v("div",oe,[e("div",re,[e("div",ie,[(c(!0),v(A,null,F(W.value,(a,u)=>(c(),v("div",{class:"stat-card-kpi",key:u},[e("div",{class:B(["kpi-icon-wrapper",a.type])},[r(o,{size:24},{default:p(()=>[(c(),Y(Z(a.icon)))]),_:2},1024)],2),e("div",ne,[e("div",de,i(a.label),1),e("div",ce,[e("span",ue,i(a.value),1),a.unit?(c(),v("span",ve,i(a.unit),1)):ee("",!0)]),e("div",pe,i(a.subText),1)]),t[0]||(t[0]=e("div",{class:"card-corner corner-tr"},null,-1)),t[1]||(t[1]=e("div",{class:"card-corner corner-bl"},null,-1))]))),128))]),e("div",fe,[e("div",me,[e("div",_e,[e("div",ge,[r(o,null,{default:p(()=>[r(d(te))]),_:1}),t[2]||(t[2]=e("span",null,"电压电流实时趋势",-1))]),e("div",he,[r(C,{size:"small",effect:"dark",class:"status-tag"},{default:p(()=>[...t[3]||(t[3]=[D("实时监控中",-1)])]),_:1})])]),e("div",{ref_key:"voltageChartRef",ref:h,class:"chart-container big-chart"},null,512)]),e("div",be,[e("div",ye,[e("div",xe,[r(o,null,{default:p(()=>[r(d(E))]),_:1}),t[4]||(t[4]=e("span",null,"实时数据监控",-1))])]),e("div",Ce,[e("div",Se,[t[5]||(t[5]=e("div",{class:"panel-title"},"三相电压 (V)",-1)),e("div",ke,[(c(),v(A,null,F(["A","B","C"],(a,u)=>e("div",{class:"data-cell",key:a},[e("span",we,i(a)+"相",1),e("span",{class:B(["cell-value",G(d(n).voltage[u]||0,380,420)])},i((d(n).voltage[u]||0).toFixed(1)),3)])),64))])]),t[11]||(t[11]=e("div",{class:"panel-divider"},null,-1)),e("div",Ae,[t[6]||(t[6]=e("div",{class:"panel-title"},"三相电流 (A)",-1)),e("div",Fe,[(c(),v(A,null,F(["A","B","C"],(a,u)=>e("div",{class:"data-cell",key:a},[e("span",De,i(a)+"相",1),e("span",Be,i((d(n).current[u]||0).toFixed(1)),1)])),64))])]),t[12]||(t[12]=e("div",{class:"panel-divider"},null,-1)),e("div",Le,[e("div",Te,[t[8]||(t[8]=e("span",{class:"cell-label"},"总功率",-1)),e("span",ze,[D(i(O.value.toFixed(2))+" ",1),t[7]||(t[7]=e("span",{class:"unit"},"kW",-1))])]),e("div",Re,[t[10]||(t[10]=e("span",{class:"cell-label"},"平均温度",-1)),e("span",{class:B(["cell-value",M(L.value)])},[D(i(L.value.toFixed(1))+" ",1),t[9]||(t[9]=e("span",{class:"unit"},"°C",-1))],2)])])])])]),e("div",Ee,[e("div",Ve,[e("div",Oe,[e("div",We,[r(o,null,{default:p(()=>[r(d(ae))]),_:1}),t[13]||(t[13]=e("span",null,"设备状态分布",-1))])]),e("div",{ref_key:"deviceStatusChartRef",ref:b,class:"chart-container"},null,512)]),e("div",Ie,[e("div",Ne,[e("div",$e,[r(o,null,{default:p(()=>[r(d(se))]),_:1}),t[14]||(t[14]=e("span",null,"告警分类统计",-1))])]),e("div",{ref_key:"alarmChartRef",ref:y,class:"chart-container"},null,512)])])])])}}}),qe=le(Ge,[["__scopeId","data-v-ee2e5fb4"]]);export{qe as default};
