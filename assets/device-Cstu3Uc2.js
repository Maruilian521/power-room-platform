import{aP as m,r as s}from"./index-BFAmLiXm.js";const S=m("device",()=>{const h=s([]),c=s([]),i=s([]),l=s([]),u=s({totalDevices:0,onlineDevices:0,offlineDevices:0,warningDevices:0,alarmDevices:0,totalAlarms:0,criticalAlarms:0,warningAlarms:0,infoAlarms:0,totalWorkOrders:0,pendingWorkOrders:0,completedWorkOrders:0}),p=s({timestamp:"",voltage:[],current:[],power:[],temperature:[]}),r=s(!1),v=async()=>{try{const t=await(await fetch("/api/rooms")).json();h.value=t.data}catch(e){console.error("获取配电室列表失败:",e)}},d=async()=>{r.value=!0;try{const t=await(await fetch("/api/devices")).json();c.value=t.data}catch(e){console.error("获取设备列表失败:",e)}finally{r.value=!1}},w=async e=>{try{return(await(await fetch(`/api/devices/${e}`)).json()).data}catch(t){return console.error("获取设备详情失败:",t),null}},y=async()=>{r.value=!0;try{const t=await(await fetch("/api/alarms")).json();i.value=t.data}catch(e){console.error("获取告警列表失败:",e)}finally{r.value=!1}},f=async()=>{r.value=!0;try{const t=await(await fetch("/api/workorders")).json();l.value=t.data}catch(e){console.error("获取工单列表失败:",e)}finally{r.value=!1}},n=async()=>{try{const t=await(await fetch("/api/statistics")).json();u.value=t.data}catch(e){console.error("获取统计数据失败:",e)}};return{devices:c,alarms:i,workOrders:l,statistics:u,realtimeData:p,loading:r,fetchRooms:v,fetchDevices:d,fetchDevice:w,fetchAlarms:y,fetchWorkOrders:f,fetchStatistics:n,fetchRealtimeData:async()=>{try{const t=await(await fetch("/api/realtime")).json();p.value=t.data}catch(e){console.error("获取实时数据失败:",e)}},updateDeviceStatus:async(e,t)=>{try{const o=await(await fetch(`/api/devices/${e}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).json();return o.code===200&&(await d(),await n()),o.data}catch(a){return console.error("更新设备状态失败:",a),null}},updateWorkOrderStatus:async(e,t)=>{try{const o=await(await fetch(`/api/workorders/${e}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).json();return o.code===200&&(await f(),await n()),o.data}catch(a){return console.error("更新工单状态失败:",a),null}}}});export{S as u};
