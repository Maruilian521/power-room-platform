import{d as oe,p as ne,r as f,m as E,o as ie,c as _,b as o,j as a,w as re,l as s,A as r,F as ue,i as de,aA as ce,E as x,C as I,B as i,O as pe,a2 as _e,a7 as me,n as h,D as fe,t as n,k as M,g as N,N as P,K as T,L as ve,Z as ge,at as be,J as ye,aO as we,V as W,U as ke,f as c,_ as xe}from"./index-BFAmLiXm.js";import{u as he}from"./device-Cstu3Uc2.js";const Ce={class:"page-container"},De={class:"device-list"},Ve={class:"main-content module-card"},ze={style:{"margin-bottom":"20px",display:"flex","justify-content":"space-between","align-items":"center"}},Se={class:"left-tools"},Fe={style:{display:"flex",gap:"12px"}},Me={key:0,class:"unit-grid"},Ne=["onClick"],Te={class:"unit-visual"},Ue={class:"unit-info"},Le=["title"],$e={class:"unit-type"},je={class:"unit-meta"},Be={class:"meta-row"},Re={class:"val"},Ae={key:0,class:"meta-row"},Ee={class:"val"},Ie={key:1,class:"meta-row"},Pe={class:"unit-actions"},We={key:1},Oe={style:{"font-family":"'Rajdhani'"}},Je={style:{"font-family":"'Rajdhani'"}},Ke={key:1},Ze={class:"time-text"},qe={style:{"margin-top":"20px",display:"flex","justify-content":"flex-end"}},Ge={key:0,class:"sc2-info-panel"},He=oe({__name:"DeviceList",setup(Qe){const C=he(),{devices:O,loading:J}=ne(C),D=f("grid"),y=f(""),w=f(""),V=f(1),k=f(20),z=f(!1),u=f(null),U=E(()=>{let l=O.value;if(y.value){const e=y.value.toLowerCase();l=l.filter(d=>d.name?.toLowerCase().includes(e)||d.id?.toLowerCase().includes(e))}return w.value&&(l=l.filter(e=>e.status===w.value)),l}),L=E(()=>{const l=(V.value-1)*k.value,e=l+k.value;return U.value.slice(l,e)}),S=l=>({transformer:"变压器",switch:"开关柜",sensor:"传感器",breaker:"断路器",capacitor:"电容器",camera:"摄像头",robot:"巡检机器人"})[l]||l,K=l=>({transformer:"danger",switch:"warning",sensor:"info",breaker:"success",capacitor:"",camera:"",robot:"primary"})[l]||"",$=l=>({online:"在线",offline:"离线",warning:"告警",alarm:"故障"})[l]||l,Z=l=>({transformer:we,switch:ye,sensor:be,breaker:ge,capacitor:T,camera:ve,robot:T})[l]||T,q=(l,e,d)=>l<e||l>d?"var(--color-danger)":l<e+5||l>d-5?"var(--color-warning)":"var(--color-success)",j=l=>l>60?"var(--color-danger)":l>50?"var(--color-warning)":"var(--color-success)",B=l=>new Date(l).toLocaleString("zh-CN"),F=l=>{u.value=l,z.value=!0},R=l=>{W.info("编辑功能开发中...")},G=async l=>{const e=l.status==="online"?"停用":"启用";try{await ke.confirm(`确定要${e}设备 ${l.name} 吗?`,"确认操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const d=l.status==="online"?"offline":"online";await C.updateDeviceStatus(l.id,d),W.success(`${e}成功`)}catch{}};return ie(()=>{C.fetchDevices()}),(l,e)=>{const d=r("el-icon"),A=r("el-radio-button"),H=r("el-radio-group"),Q=r("el-input"),v=r("el-option"),X=r("el-select"),g=r("el-button"),p=r("el-table-column"),Y=r("el-tag"),ee=r("el-table"),te=r("el-pagination"),m=r("el-descriptions-item"),ae=r("el-descriptions"),le=r("el-dialog"),se=ce("loading");return c(),_("div",Ce,[o("div",De,[o("div",Ve,[e[17]||(e[17]=o("div",{class:"module-header"},[o("span",{class:"title"},"设备资源库 (ASSETS)")],-1)),o("div",ze,[o("div",Se,[a(H,{modelValue:D.value,"onUpdate:modelValue":e[0]||(e[0]=t=>D.value=t),size:"small",class:"sc2-radio-group"},{default:s(()=>[a(A,{label:"list"},{default:s(()=>[a(d,null,{default:s(()=>[a(x(pe))]),_:1}),e[6]||(e[6]=i(" 列表",-1))]),_:1}),a(A,{label:"grid"},{default:s(()=>[a(d,null,{default:s(()=>[a(x(_e))]),_:1}),e[7]||(e[7]=i(" 视图",-1))]),_:1})]),_:1},8,["modelValue"])]),o("div",Fe,[a(Q,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=t=>y.value=t),placeholder:"搜索设备名称或ID",style:{width:"300px"},clearable:"",class:"sc2-input"},{prefix:s(()=>[a(d,null,{default:s(()=>[a(x(me))]),_:1})]),_:1},8,["modelValue"]),a(X,{modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=t=>w.value=t),placeholder:"筛选状态",clearable:"",style:{width:"150px"}},{default:s(()=>[a(v,{label:"全部",value:""}),a(v,{label:"在线",value:"online"}),a(v,{label:"离线",value:"offline"}),a(v,{label:"告警",value:"warning"}),a(v,{label:"故障",value:"alarm"})]),_:1},8,["modelValue"])])]),D.value==="grid"?(c(),_("div",Me,[(c(!0),_(ue,null,de(L.value,t=>(c(),_("div",{key:t.id,class:h(["sc2-unit-card",t.status]),onClick:b=>F(t)},[o("div",Te,[a(d,{size:40,class:"unit-icon"},{default:s(()=>[(c(),I(fe(Z(t.type))))]),_:2},1024),o("div",{class:h(["unit-status-bar",t.status])},null,2)]),o("div",Ue,[o("div",{class:"unit-name",title:t.name},n(t.name),9,Le),o("div",$e,n(S(t.type)),1),o("div",je,[o("div",Be,[e[8]||(e[8]=o("span",{class:"label"},"LOC:",-1)),o("span",Re,n(t.roomName),1)]),t.voltage?(c(),_("div",Ae,[e[9]||(e[9]=o("span",{class:"label"},"PWR:",-1)),o("span",Ee,n(t.voltage.toFixed(1))+" V",1)])):M("",!0),t.temperature?(c(),_("div",Ie,[e[10]||(e[10]=o("span",{class:"label"},"TMP:",-1)),o("span",{class:"val",style:N({color:j(t.temperature)})},n(t.temperature.toFixed(1))+" °C",5)])):M("",!0)]),o("div",Pe,[a(g,{size:"small",type:"primary",link:"",onClick:P(b=>F(t),["stop"])},{default:s(()=>[...e[11]||(e[11]=[i("详情",-1)])]),_:1},8,["onClick"]),a(g,{size:"small",type:"warning",link:"",onClick:P(b=>R(),["stop"])},{default:s(()=>[...e[12]||(e[12]=[i("维护",-1)])]),_:1},8,["onClick"])])]),e[13]||(e[13]=o("div",{class:"card-corner corner-tr"},null,-1)),e[14]||(e[14]=o("div",{class:"card-corner corner-bl"},null,-1))],10,Ne))),128))])):re((c(),I(ee,{key:1,data:L.value,stripe:"",style:{width:"100%"},class:"sc2-table"},{default:s(()=>[a(p,{prop:"id",label:"设备ID",width:"140"}),a(p,{prop:"name",label:"设备名称",width:"200"}),a(p,{prop:"type",label:"设备类型",width:"140"},{default:s(({row:t})=>[a(Y,{type:K(t.type),effect:"dark"},{default:s(()=>[i(n(S(t.type)),1)]),_:2},1032,["type"])]),_:1}),a(p,{prop:"status",label:"运行状态",width:"120"},{default:s(({row:t})=>[o("span",{class:h(["status-badge",t.status])},n($(t.status)),3)]),_:1}),a(p,{prop:"roomName",label:"所属配电室",width:"180"}),a(p,{prop:"voltage",label:"电压(V)",width:"120"},{default:s(({row:t})=>[t.voltage!==void 0?(c(),_("span",{key:0,style:N({color:q(t.voltage,380,420),fontFamily:"Rajdhani",fontWeight:"bold"})},n(t.voltage.toFixed(1)),5)):(c(),_("span",We,"-"))]),_:1}),a(p,{prop:"current",label:"电流(A)",width:"120"},{default:s(({row:t})=>[o("span",Oe,n(t.current?.toFixed(1)||"-"),1)]),_:1}),a(p,{prop:"power",label:"功率(kW)",width:"120"},{default:s(({row:t})=>[o("span",Je,n(t.power?.toFixed(1)||"-"),1)]),_:1}),a(p,{prop:"temperature",label:"温度(°C)",width:"120"},{default:s(({row:t})=>[t.temperature!==void 0?(c(),_("span",{key:0,style:N({color:j(t.temperature),fontFamily:"Rajdhani"})},n(t.temperature.toFixed(1)),5)):(c(),_("span",Ke,"-"))]),_:1}),a(p,{prop:"lastUpdate",label:"更新时间",width:"180"},{default:s(({row:t})=>[o("span",Ze,n(B(t.lastUpdate)),1)]),_:1}),a(p,{label:"操作",fixed:"right",width:"180"},{default:s(({row:t})=>[a(g,{size:"small",type:"primary",link:"",onClick:b=>F(t)},{default:s(()=>[...e[15]||(e[15]=[i(" 详情 ",-1)])]),_:1},8,["onClick"]),a(g,{size:"small",type:"warning",link:"",onClick:b=>R(t)},{default:s(()=>[...e[16]||(e[16]=[i(" 编辑 ",-1)])]),_:1},8,["onClick"]),a(g,{size:"small",type:t.status==="online"?"danger":"success",link:"",onClick:b=>G(t)},{default:s(()=>[i(n(t.status==="online"?"停用":"启用"),1)]),_:2},1032,["type","onClick"])]),_:1})]),_:1},8,["data"])),[[se,x(J)]]),o("div",qe,[a(te,{"current-page":V.value,"onUpdate:currentPage":e[3]||(e[3]=t=>V.value=t),"page-size":k.value,"onUpdate:pageSize":e[4]||(e[4]=t=>k.value=t),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:U.value.length},null,8,["current-page","page-size","total"])])]),a(le,{modelValue:z.value,"onUpdate:modelValue":e[5]||(e[5]=t=>z.value=t),title:"设备详情",width:"600px",class:"sc2-dialog"},{default:s(()=>[u.value?(c(),_("div",Ge,[a(ae,{column:2,border:"",class:"sc2-descriptions"},{default:s(()=>[a(m,{label:"设备ID"},{default:s(()=>[i(n(u.value.id),1)]),_:1}),a(m,{label:"设备名称"},{default:s(()=>[i(n(u.value.name),1)]),_:1}),a(m,{label:"设备类型"},{default:s(()=>[i(n(S(u.value.type)),1)]),_:1}),a(m,{label:"运行状态"},{default:s(()=>[o("span",{class:h(["status-badge",u.value.status])},n($(u.value.status)),3)]),_:1}),a(m,{label:"所属配电室"},{default:s(()=>[i(n(u.value.roomName),1)]),_:1}),a(m,{label:"电压"},{default:s(()=>[i(n(u.value.voltage?.toFixed(2)||"-")+" V",1)]),_:1}),a(m,{label:"电流"},{default:s(()=>[i(n(u.value.current?.toFixed(2)||"-")+" A",1)]),_:1}),a(m,{label:"功率"},{default:s(()=>[i(n(u.value.power?.toFixed(2)||"-")+" kW",1)]),_:1}),a(m,{label:"温度"},{default:s(()=>[i(n(u.value.temperature?.toFixed(2)||"-")+" °C",1)]),_:1}),a(m,{label:"更新时间"},{default:s(()=>[i(n(B(u.value.lastUpdate)),1)]),_:1})]),_:1})])):M("",!0)]),_:1},8,["modelValue"])])])}}}),et=xe(He,[["__scopeId","data-v-4f8e7253"]]);export{et as default};
